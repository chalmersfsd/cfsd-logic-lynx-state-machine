os: linux
language: cpp
sudo: required
branches:
  only:
  - "/^test.*$/"
  - "/^v[0-9].*$/"
services:
- docker
addons:
  apt:
    update: true
env:
  global:
  - DOCKERHUB='chalmersfsd'
  - IMAGE=`echo ${TRAVIS_REPO_SLUG#*/}`
  - secure: s+9R+M5+es4lykIRugaIyT9+IVPscrHxRsTO0WQhJkKf9guvM2hEDdt3GiYaa5rHzZv/zR27qd4yJFledPNRWpWGzZIe2DZ+nSlbU1YywK95gSdJD0i+k3fbSaa5cbyCILgL1rjN0B5Y27l9cZCBQ6ZSWOsY58llQHRwceWuSVGnyhJpShVSQOJMRkU7UwwD/JI08b9IypgqftnOoUeYhSj13EO9t/FhbAbyG1w1VqMC0OyCDqN5HeRJSQfFcejI6kFLa/kB3zFFlhM+i2oDYoFS1w6OCUqSzOYYJ3wycVys3zhjry2Of71QmmrYKyQnbb/I9NTXHMR6P4/15PU3u7ijDs3RlqlQbL0qK/fcplY3V2OUyPJNVWWaSNYmVemRssRtXQeyveuZekPy7VpLLXNgLyE69ye/L4+pkvZvLmbkjdNZcspvR8okNPfAHCFROz3ok7P70x11QDpKGVYjp5kK39jnMVJz13mmJPzX4NVZPUyMxd/promoJzm2Ye9XvODCgWIQlkVHoMN7CrwWbNIyJ0UdlNNZOMuYA6qikWB3EVmvJ6GYkvj31r0y/HBxJPm4lXR/m8O4uDEwBd+VKNlman8qHkuDWhlmjBEPAoU1ypnSYmsqixEZcKsNm8gCvBOO9Ne2h5u+r6AcmTV0GFMiXBJsLQtArYRYD02FrgM=
  - secure: I4PMb0Ask9k8Wnl5BPRIm435bPTbruQWI+NKMbalnuoRStuj3SZL1BvyHTIjhcvOt6YL9MSjKCdyFi9CtucfudYddN9EsYG6nTlNWDIWsK6vjKih9ywRyu/LDM26ovs0jnJBfSWmPzWoC7Z54+WvcdA4TfQQf7m3Zy1U1jJiAOAMpprfbmGPMUO6j23xduppdNNzTLYT3QQ3T6JhzttLTBfuxh4pcLy5WLWaYy4bRE2/X2rbotK6wdP8n5HxoVrTl+OyBKtLhMI8FEnBZWnY2AsZ6y64UBFealdiijXxnIdprA1FYrYpkxmI6jV0/70PhtVstDXF9Ws/MO50eifEDsmdYAcmbGdeN9l+7KgxkkKcbSUTcgBDXS9HPcV8lgW7/nOmWSfmmxSaYHiYyrCjGDOL4Ivlc7OFPCSqZ6MudzHz3M/hrHmRgWEhLnjztsMcGXw2U3aMq47vXS4s9UwO86EAO6NbuN3CfCr73YZNaFyEQzhMecdnm9LwhhvhYMQoiuEh+ob6MpGXuhIP3Q4u0WQjPvutUagqnrxlPuCIELiYVaye7mYsuA2OiIO6yiknzutElwDPZ7kO0n7dlJiifpYgH5O87vtxtwGf8yT4czpwlN3d59OsYVuaTNV02wd/YhzaiJHT2Zi5EcFy7qvyVausL1VCaN4BhTn/Ji5DTO0=
install:
- docker build -f Dockerfile.amd64 -t ${IMAGE} .
script: skip
after_success:
- echo "$DOCKER_PASS" | docker login -u "$DOCKER_USER" --password-stdin
- if [[ "${TRAVIS_BRANCH}" == *test* ]]; then docker tag ${IMAGE} ${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}${TRAVIS_BUILD_NUMBER};
  docker push ${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}${TRAVIS_BUILD_NUMBER}; echo "${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}${TRAVIS_BUILD_NUMBER}";
  else docker tag ${IMAGE} ${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}; docker push ${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH};
  echo "${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}"; fi
notifications:
  email:
    on_success: never
    on_failure: never
