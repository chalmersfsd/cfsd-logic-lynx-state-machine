os: linux
language: cpp
sudo: required
branches:
  only:
  - "/^test.*$/"
  - "/^v[0-9].*$/"
services:
- docker
addons:
  apt:
    update: true
env:
  global:
  - DOCKERHUB='chalmersfsd'
  - IMAGE=`echo ${TRAVIS_REPO_SLUG#*/}`
  - secure: ijz5JqsRivB7b3iZUxiKvRM3QOsqBQCs3Be4Cd9sAKgPS92+Qu0ulXV3GyE1NES6slU2xi89n8K08WivIbQ1/UFweWpfajyNUEN2SQDtpxJ3zzPHWtNHB5hbUN2OlyGVjqEO/KUkktnHOClAy7m47bmMOWX1Dpl5BbU6lxafNDvewvAae4rtkXpgHLCJDXqCsqquob7foBJ0p/Tr3yRC+Nu2N7R1MXVyo/26ncIiSx/V34h0U93Vm7HQhcfrK34mfXHMdxoTqXWmFRT/R0JTgoJ6VURvzCRlcyipfgsvP4wEzBFx/g/icVDNTExvao9DPkzMsWvRhQOrWzRZnxIWrbozCGRdLgUYVrdmLPCI27ONkrdzCDmzcpaeIbXHMQojTDYPS6d6YpC3biHRPO6rZpOG11v51qwL9Ekbmsc0xmkEoL9EAW1oQ9f9TRIX+Hw98hnDilWYlhopnV/gpjkrhOf3vG7e55Mwn/v30vssAXoryV6NJgdqfeFsQnDspAq7EPdsfVuSa0lr2daS5DYKRsvJFUqJmMLSWYrBLNoixhoE9b5oJbX8R2A/NrgJeRXIcPb3OqEgZKfVAbelvRxubOO5no6Yk3s/gYDKz1d/jA25d3t5iox0lOVMyfDt6W5HTsIRjMlTu6fpEuO/3K4aaoTLEyqtkLvn/zX+Ff2/yd0=
  - secure: acuJSJE5SJAz+EhVSdxqTUlMO3d/u4am61CKir/a249FaX/YNioG/6Gr9LBRkEUx6TOH13+V9Z7ikn9ltAVfk4Y93T9wDuY3xJ8NC7Drs6aYczv/zVMCvcLiDKrkgd6xFP1XLYnvcYPyepQgykDQ4Dvr0n/gL46uClkDuznDvjG5iwRofMwo7JFSWfSnm1vt2cIsB9Dv4brochr5jYoLmf7+Ka0Za9+CvZhgcJaxY11/6E0kwjgeMxn1/8NSQVIPzODK9Kxd0V0iAaAT/24yXF4E7pY8aVzcRD7PMgSlq8VbpdGSzh2/HpJRowLK2eT7O8RPbr2+HyHo+qx/36jA4gwNl0JN204tAQazYVvVYUmxQCmBaWCwJPFr5P0QvEJrWC3RSuKkVfwWInBcIIJgvoOCpDSJEEX+UIK18zTy6NMbQHQGGyLIL+wGZLQKZifSTpXo0LLzCAg+zeRPoCLm7cGBovXeJ+U9/M60dfjF8kHIt0kBnC1t+unJv5O1F2RYzKUar4dcVVzw2t1Gdiudn6F4TMPbeIFgn1qiXM+ua9XnjbkdbM5Hjagku9JFdsc3sBRX9WjKJJiaNBAlbziMZh/UXzSHm0/waAbXlSwvaBxRXVjNgLW1GSzou88sAwf1bG+1DuGipsqN0f0+Qa7byLfUfhSWGiN7JomaWuLkTnE=
install:
- docker build -f Dockerfile.amd64 -t ${IMAGE} .
script: skip
after_success:
- echo "$DOCKER_PASS" | docker login -u "$DOCKER_USER" --password-stdin
- if [[ "${TRAVIS_BRANCH}" == *test* ]]; then docker tag ${IMAGE} ${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}${TRAVIS_BUILD_NUMBER};
  docker push ${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}${TRAVIS_BUILD_NUMBER}; echo "${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}${TRAVIS_BUILD_NUMBER}";
  else docker tag ${IMAGE} ${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}; docker push ${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH};
  echo "${DOCKERHUB}/${IMAGE}:${TRAVIS_BRANCH}"; fi
notifications:
  email:
    on_success: never
    on_failure: never
